{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Iniciar Sesión - Grupo EM</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Notyf CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: linear-gradient(135deg, #1a237e, #0d47a1);
        }

        #octagon-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .octagon {
            position: absolute;
            opacity: 0.3;
            animation-timing-function: cubic-bezier(0.42, 0, 0.58, 1);
        }

        /* Animación para octágonos grandes (más cercanos) */
        .octagon.large {
            animation: float-large 25s infinite ease-in-out;
            opacity: 0.2;
        }

        /* Animación para octágonos medianos */
        .octagon.medium {
            animation: float-medium 35s infinite ease-in-out;
            opacity: 0.15;
        }

        /* Animación para octágonos pequeños (más lejanos) */
        .octagon.small {
            animation: float-small 45s infinite ease-in-out;
            opacity: 0.1;
        }

        @keyframes float-large {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg);
            }
            20% {
                transform: translate(15vw, 10vh) rotate(72deg);
            }
            40% {
                transform: translate(-10vw, 20vh) rotate(144deg);
            }
            60% {
                transform: translate(20vw, -5vh) rotate(216deg);
            }
            80% {
                transform: translate(-15vw, 15vh) rotate(288deg);
            }
        }

        @keyframes float-medium {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg);
            }
            25% {
                transform: translate(-20vw, 15vh) rotate(90deg);
            }
            50% {
                transform: translate(15vw, -10vh) rotate(180deg);
            }
            75% {
                transform: translate(-10vw, -20vh) rotate(270deg);
            }
        }

        @keyframes float-small {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg);
            }
            33% {
                transform: translate(25vw, 20vh) rotate(120deg);
            }
            66% {
                transform: translate(-20vw, 25vh) rotate(240deg);
            }
        }

        .card-custom {
            border-radius: 1rem;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
        }

        .img-custom {
            border-radius: 1rem 0 0 1rem;
        }
    </style>
</head>
<body>
    <!-- Contenedor para los octágonos animados -->
    <div id="octagon-container"></div>

    <section class="vh-100">
        <div class="container py-5 h-100">
            <div class="row d-flex justify-content-center align-items-center h-100">
                <div class="col col-xl-10">
                    <div class="card card-custom">
                        <div class="row g-0">
                            <!-- Lado izquierdo con imagen -->
                            <div class="col-md-6 col-lg-5 d-none d-md-block">
                                <img src="{% static 'img/imagen-login.png' %}"
                                     alt="login form" class="img-fluid img-custom"/>
                            </div>
                            <!-- Lado derecho con formulario -->
                            <div class="col-md-6 col-lg-7 d-flex align-items-center">
                                <div class="card-body p-4 p-lg-5 text-black">

                                    <div class="d-flex align-items-center mb-3 pb-1">
                                        <i class="fa-solid fa-record-vinyl fa-2x me-3" style="color: #196dff;"></i>
                                        <span class="h1 fw-bold mb-0">Grupo EM</span>
                                    </div>

                                    <h5 class="fw-normal mb-3 pb-3" style="letter-spacing: 1px;">Inicia sesión en tu
                                        cuenta</h5>

                                    <form method="POST">
                                        {% csrf_token %}
                                        <!-- Campo de nombre de usuario -->
                                        <div data-mdb-input-init class="form-outline mb-4">
                                            {{ form.username }}
                                            <label class="form-label" for="{{ form.username.id_for_label }}">Nombre de
                                                usuario</label>
                                        </div>
                                        <!-- Campo de contraseña -->
                                        <div data-mdb-input-init class="form-outline mb-4">
                                            {{ form.password }}
                                            <label class="form-label"
                                                   for="{{ form.password.id_for_label }}">Contraseña</label>
                                        </div>

                                        <div class="pt-1 mb-4">
                                            <button id="btnIngresar" type="submit" class="btn btn-dark btn-lg w-100">
                                                <span id="spinner" class="spinner-border spinner-border-sm d-none me-2" role="status" aria-hidden="true"></span>
                                                <span id="btnText">Ingresar</span>
                                            </button>
                                        </div>

                                        <a class="small text-muted" href="#!">¿Olvidaste tu contraseña?</a>
                                        <p class="mb-5 pb-lg-2" style="color: #393f81;">
                                            ¿No tienes cuenta? <a href="#!" style="color: #393f81;">Regístrate aquí</a>
                                        </p>
                                        <a href="#" class="small text-muted">Términos de uso.</a>
                                        <a href="#" class="small text-muted">Política de privacidad</a>
                                    </form>

                                </div>
                            </div>
                            <!-- Fin lado derecho -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Notyf JS -->
    <script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
    
    <script>
        // Crear octágonos animados
        function createOctagons() {
            const container = document.getElementById('octagon-container');
            const colors = ['#1976d2', '#2196f3', '#64b5f6', '#90caf9', '#bbdefb'];
            
            // Crear diferentes tamaños de octágonos para efecto de profundidad
            for (let i = 0; i < 35; i++) {
                const octagon = document.createElement('div');
                
                // Determinar tamaño y clase según el índice
                let size, className;
                if (i < 10) {
                    // Octágonos grandes
                    size = Math.random() * 100 + 80;
                    className = 'large';
                } else if (i < 25) {
                    // Octágonos medianos
                    size = Math.random() * 60 + 40;
                    className = 'medium';
                } else {
                    // Octágonos pequeños
                    size = Math.random() * 40 + 20;
                    className = 'small';
                }
                
                octagon.classList.add('octagon', className);
                
                // Posición aleatoria
                const left = Math.random() * 100;
                const top = Math.random() * 100;
                
                // Color aleatorio
                const color = colors[Math.floor(Math.random() * colors.length)];
                
                // Retraso de animación aleatorio
                const delay = Math.random() * 20;
                
                octagon.style.width = `${size}px`;
                octagon.style.height = `${size}px`;
                octagon.style.left = `${left}%`;
                octagon.style.top = `${top}%`;
                octagon.style.animationDelay = `${delay}s`;
                
                // Crear SVG para el octágono
                octagon.innerHTML = `
                    <svg width="${size}" height="${size}" viewBox="0 0 100 100">
                        <polygon points="30,0 70,0 100,30 100,70 70,100 30,100 0,70 0,30" 
                                 fill="${color}" />
                    </svg>
                `;
                
                container.appendChild(octagon);
            }
        }
        
        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', createOctagons);
        
        const notyf = new Notyf({
            duration: 5000,
            position: {x: 'right', y: 'top'},
            dismissible: true
        });

        // Mostrar los mensajes de error de Django usando Notyf
        {% if messages %}
            {% for message in messages %}
                notyf.error("{{ message }}");
            {% endfor %}
        {% endif %}
    </script>

    <script>
        document.querySelector('form').addEventListener('submit', function () {
            const btn = document.getElementById('btnIngresar');
            const spinner = document.getElementById('spinner');
            const btnText = document.getElementById('btnText');

            // Mostrar spinner y desactivar botón
            spinner.classList.remove('d-none');
            btnText.textContent = 'Ingresando...';
            btn.disabled = true;
        });
    </script>
</body>
</html>